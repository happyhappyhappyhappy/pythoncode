島を頂点、橋を辺としたグラフを考えます。グラフから辺を削除していくのは難しいことが多いので、逆に辺が 1 つもない状態から追加していくことを考えます。すなわち、後ろから答えを求めて配列に保存し、逆順に出力します。

$i$ 番目に出力すべき答えを $ans(i)$ とします。辺を追加していくことを考えると、初めは全ての辺がないので、
$ans(M)=\frac{N*(N+1)}{2}$
です。
さらに、各$i(1\leq i\leq M-1)$ について、
$i + 1$ 番目の辺 $e_{i+1} = (a_{i+1},b_{i+1})$ によって

1. 元々頂点 $a_{i+1}, b_{i+1}$ が連結でなかった
(互いに行き来可能でなかった) 場合
辺 $e$ を加える前のグラフにおいて、頂点 $a_{i+1}$を含む連結成分の大きさを $N_{1}$、頂点 $b_{i+1}$ を含む連結成分の大きさを $N_{2}$ とすると、

$ans(i) = ans(i + 1) - N_{1}\times N_{2}$

です。

2. 元々連結だった場合

不便さに変化はなく、$ans(i) = ans(i + 1)$ です。

しかしこれを愚直に実装すると $O(M (N + M ))$ かかってしまい、間に合いません。
ボトルネックになっているところは、$N_{1},N_{2}$ を求める部分です。これは、以下の操作が行える、Union-Find と呼ばれるデータ構造を
用いることで効率よく求めることができます。

- $unite(u,v)$  : 頂点 $u$ が属するグループと頂点 $v$ が属するグループを併合し、同じグループにする。$(O(\alpha (n)))$
- $find(v)$: 頂点 $v$ が属するグループ番号を得る。$(O(\alpha (n)))$
- $size(v)$: 頂点 $v$ が属するグループと同じグループに属する頂点数を得る $(O(1))$

ここで、$n$ は管理する頂点数、$\alpha$  はアッカーマン関数の逆関数ですが、$(O(\alpha (n)))$ は $O(1)$ とほとんど変わりません。
したがって、全体の計算量は $O(M\alpha (N)))$ となり十分間に合います。
